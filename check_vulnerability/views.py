from rest_framework import status
from rest_framework import viewsets
from rest_framework.response import Response

# Create your views here.


from check_vulnerability.utils import SeleniumXSS


class FindVulnerabilityViewSet(viewsets.ViewSet):
    """
    """

    def create(self, request):
        url = self.request.data.get('url')
        depth = self.request.data.get('depth')
        shit = SeleniumXSS(url, headless=True)

        result = shit.find_vulnerability(depth)

        return Response(result, status=status.HTTP_200_OK)
